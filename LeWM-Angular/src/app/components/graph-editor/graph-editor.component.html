<div class="graph-editor">
  <div class="toolbar">
    <h3>Node Library</h3>
    <div class="node-buttons">
      <button *ngFor="let node of availableNodes" 
              (click)="addNode(node.type)"
              class="node-btn">
        + {{ node.label }}
      </button>
    </div>
    
    <div class="controls">
      <h4>Controls</h4>
      <button (click)="clearConnections()" class="clear-btn">
        Clear Edges
      </button>
      <div class="info">
        <p>Selected: {{ selectedNodes.size }}</p>
        <small>Click to select • Ctrl+Click for multi-select • Delete to remove selected nodes</small>
      </div>
    </div>
  </div>
  
  <div class="canvas-container">
    <svg #svgCanvas 
         class="graph-canvas"
         width="100%" 
         height="100%"
         (mousedown)="onMouseDown($event)"
         (mousemove)="onMouseMove($event)"
         (mouseup)="onMouseUp($event)">
      
      <!-- Grid pattern (can be moved to a shared SVG defs component later) -->
      <defs>
        <pattern id="grid" width="20" height="20" patternUnits="userSpaceOnUse">
          <path d="M 20 0 L 0 0 0 20" fill="none" stroke="#f0f0f0" stroke-width="1"/>
        </pattern>
      </defs>
      <rect width="100%" height="100%" fill="url(#grid)" />
      
      <!-- Graph Nodes -->
      <g *ngFor="let node of nodes" 
         [attr.id]="node.id"
         (mousedown)="onNodeMouseDown($event, node.id)"
         [attr.class]="'graph-node-group ' + (selectedNodes.has(node.id) ? 'selected' : '')">
        <rect [attr.x]="node.x" 
              [attr.y]="node.y" 
              [attr.width]="node.width" 
              [attr.height]="node.height"
              [attr.fill]="selectedNodes.has(node.id) ? '#4a90e2' : '#f0f0f0'"
              stroke="#333" 
              stroke-width="2"
              class="graph-node-body" />
        <text [attr.x]="node.x + node.width/2" 
              [attr.y]="node.y + node.height/2 + 5" 
              text-anchor="middle" 
              font-size="12" 
              font-weight="bold">
          {{ node.label }}
        </text>
      </g>
      
      <!-- Selection box -->
      <rect *ngIf="selectionBox"
            [attr.x]="Math.min(selectionBox.startX, selectionBox.endX)"
            [attr.y]="Math.min(selectionBox.startY, selectionBox.endY)"
            [attr.width]="Math.abs(selectionBox.endX - selectionBox.startX)"
            [attr.height]="Math.abs(selectionBox.endY - selectionBox.startY)"
            fill="rgba(74, 144, 226, 0.2)"
            stroke="#4a90e2"
            stroke-width="2"
            stroke-dasharray="5,5"
            pointer-events="none" />
    </svg>
  </div>
</div>